## 1. UDP 为什么比 TCP 速度快? 为什么 TCP 数据传输可靠而 UDP 数据传输不可靠?

UDP（用户数据报协议）比 TCP（传输控制协议）速度快主要是因为它的设计更简单，而且没有 TCP 那样的错误检测和修正，流量控制以及数据排序等机制的开销。

UDP 将应用程序发送的信息封装成数据包或者说"数据报"，然后就直接发送出去，无需建立连接、也不确认对方是否接收到。因此，在网络状态良好的情况下，UDP 通常比 TCP 更快。

然而，这种设计使得 UDP 在数据传输的可靠性上不如 TCP。因为 UDP 没有错误恢复机制，如果数据包在传输过程中丢失，UDP 不会自动重发，应用程序也不会收到任何通知。并且，UDP 数据报可能会乱序到达，并且也可能会被重复发送。

相比之下，TCP 尽管在速度上不如 UDP，但在可靠性和数据完整性上要优于 UDP。TCP 使用一种被称为三次握手的机制来建立连接，然后将数据分割成有序的数据包进行发送，所有的包都会被确认接收，并且如果必要，还可以对丢失的包进行重发。因此，TCP 可以保证数据正确无误的到达目的地。


## 2. 下列不属于 UDP 特点的是?

a. UDP 不同于 TCP，不存在连接的概念，所以不像 TCP 那样只能进行一对一的数据传输。

b. 利用 UDP 传输数据时，如果有 2 个目标，则需要 2 个套接字。

c. UDP 套接字中无法使用已分配给 TCP 的同一端口号。

d. UDP 套接字和 TCP 套接字可以共存。若需要，可以在同一主机进行 TCP 和 UDP 数据传输

e. 针对 UDP 函数也可以调用 connect 函数，此时 UDP 套接字跟 TCP 套接字相同，也需要经过 3 次握手过程。

b、c、e

b. 利用 UDP 传输数据时，如果有 2 个目标，则需要 2 个套接字。

这个说法并不完全正确。如果你想一次向两个地址发送数据，你可以继续使用同一个 UDP 套接字，只需要分别向这两个地址 sendto() 数据即可。你并不必要为每个目的地都单独创建一个套接字。所以，“利用 UDP 传输数据时，如果有 2 个目标，则需要 2 个套接字”是不正确的。

c. UDP 套接字中无法使用已分配给 TCP 的同一端口号。

这个说法并不正确。实际上，TCP 和 UDP 是两个独立的协议，它们各自维护自己的端口号，所以一个端口号可以同时被 TCP 和 UDP 使用，而不会发生冲突。例如，你可以有一个 TCP 的 8080 端口和一个 UDP 的 8080 端口同时在运行，它们是互不影响的。作为一个结果，"UDP 套接字中无法使用已分配给 TCP 的同一端口号" 不属于 UDP 的特性或者规定。

e. 针对 UDP 函数也可以调用 connect 函数，此时 UDP 套接字跟 TCP 套接字相同，也需要经过 3 次握手过程。

这个说法并不正确。虽然UDP套接字可以调用connect()函数，但是它跟TCP的行为并不一样。在TCP中，connect()函数的作用是建立连接，并进行三次握手过程。但在UDP中，connect()函数只是在内部设置了目标地址，以便后续的数据发送，但并没有实际的物理连接过程，也没有三次握手过程。因此，"针对 UDP 函数也可以调用 connect 函数，此时 UDP 套接字跟 TCP 套接字相同，也需要经过 3 次握手过程"这个说法是错误的。



## 3. UDP 数据报向对方主机的 UDP 套接字传递过程中，IP 和 UDP 分别负责哪此部分?

在UDP数据报向对方主机的UDP套接字传递过程中：

1. IP负责的部分：IP（互联网协议）负责将整个UDP数据报（包括UDP头部和数据）从发送主机传输到接收主机。IP协议通过发送和接收主机的IP地址来寻找网络上的路径。此过程中，IP协议并不关心数据包的内容，它的任务仅仅是将数据报路由到正确的主机。

2. UDP负责的部分：UDP（用户数据报协议）负责将接收到的数据报传输到正确的应用程序。这是通过UDP头部的目的端口号完成的，这个端口号表示数据报应该发送给接收主机上的哪个应用程序（或进程）。数据报到达接收主机后，操作系统会检查UDP头部的目的端口号，然后把数据报传给绑定到该端口的应用程序。

## 4. UDP 一般比 TCP 快，但根据交换数据的特点，其差异可大可小。请说明何种情况下 UDP 的性能优于 TCP?

在以下几种情况下，UDP的性能可能优于TCP：

1. 实时应用：对于如视频会议、网络电话或在线游戏等实时应用，数据包的即时交付比它们的完整性更重要。如果使用TCP，数据包的重传可能导致延迟，而UDP可以接受部分数据包的丢失，从而保证数据的实时传输。

2. 短消息通信：对于小数据量的单向传输，比如DNS查询，UDP比TCP更有优势，因为UDP没有连接建立的开销，而且数据包头部开销小。

3. 广播和多播：TCP不支持广播和多播，而UDP则可以向多个目的地发送同一份数据包，这在需要发送到多个目的地的应用中非常有用。

4. 无需流量控制的应用：对于那些无需进行流量控制的应用，比如传输大文件或者进行数据备份等，UDP可能较TCP有更好的性能，因为UDP发送数据的速率只受应用程序自身限制，而不受接收端的窗口大小或网络状况限制。

总的来说，选择使用TCP还是UDP，取决于应用的特性和对数据传输的需求。

## 5. 客户端 TCP 套接字调用 connect 函数时自动分配 IP 和端口号。UDP 中不调用 bind 函数，那何时分配 IP 和端口号?

在UDP中，如果没有显式地调用bind函数去分配端口和IP，那么系统将在你第一次调用sendto或者recvfrom进行数据发送或接收的时候自动分配一个端口号和IP地址。

也就是说，对于UDP套接字，如果你没有手动设置（通过bind）一个源IP和端口，那么操作系统会在第一次进行网络操作（比如发送或接收数据）时为你自动分配。这个过程叫做隐式绑定。这样的分配通常是动态的，并且每次网络操作可能都不同，除非你之后手动调用bind函数去改变它。


## 6. TCP 客户端必需调用 connect 函数,而 UDP 中可以选择性调用。请问,在 UDP 中调用 connect 函数有哪此好处?

在UDP中调用connect函数有以下几个好处：

1. 指定默认的接收方：调用connect函数后，我们可以直接使用send和recv函数来发送和接收数据，而不需要每次都指定目的地址和端口。系统会把在connect中指定的目的地址和端口作为默认的接收方。

2. 错误报告：如果UDP套接字在调用connect后向一个无法到达的目的地发送数据，操作系统会在后续的send或者recv调用中返回错误，比如ECONNREFUSED（Connection refused）。

3. 拒绝非目的地址的数据：一旦connect函数被调用，UDP套接字将拒绝来自所有没有在connect中指定的地址的数据包。

4. 简单的安全性控制：可以通过调用connect来实现基本的源地址过滤，只接受指定地址的UDP数据包，这种方式可以对UDP通信提供简单的安全性控制。

因此，尽管UDP是无连接的，但在某些情况下，使用connect函数能带来一些好处。


## 7. 请参考本章给出的`uecho_server.c`和`uecho_client.c`，编写示例使服务器端和客户端轮流收发消息。收发的消息均要输出到控制台窗口。



